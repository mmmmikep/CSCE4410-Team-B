<!DOCTYPE HTML>
<html>
<head >
<meta http-equiv="Access-Control-Allow-Origin" content="http://api.untappd.com">
<title>BierTime</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">

	function initialize(){

		var doneMessage = "Doneski";
		var errorMessage = "error";

	}



</script> 

<!--when run locally (ie, not on a webserver) there is an error for security reasons.  the URL json call should work when the page is live-->
<!--until then, we have a json test file to make sure the syntax for working with it works-->
<!--http://api.untappd.com/v3/user?key=d655538d2bbdcad2157eb187361e3b86&user=mmmmikep -->
<!--file:///C:/Users/KRISTINAKICKASS/jsontest.txt-->
<script type="text/javascript">

function login() { 

	$.ajax({
  url: "http://api.untappd.com/v3/",
  password: "1ea8b3ac0640e44c27b3cb8a258a87f8",
  username: "mmmmikep",
  type: "GET",
  dataType: "json",
  success:function(msg) {
  $("#results").html( msg );},
  error: function(jqXHR, textStatus) {
	$("#results").html("Request failed: " + textStatus );}
});

}


var url = "http://api.untappd.com/v3/user?key=b6077c9e633e11b65375b25eea792597&user=mmmmikep";
var key = "key=b6077c9e633e11b65375b25eea792597&";
var query = '&user=mmmmikep';

var userAPIcall = "http://api.untappd.com/v3/user?key=b6077c9e633e11b65375b25eea792597&user=";
var beerAPIcall = "http://api.untappd.com/v3/beer_search?key=b6077c9e633e11b65375b25eea792597&sort=count&q=";
var beerInfocall = "http://api.untappd.com/v3/beer_info?key=b6077c9e633e11b65375b25eea792597&bid=";
var untappdAPIcall="";

function beerclick(uid){
	var bidURL = "http://api.untappd.com/v3/beer_info?key=b6077c9e633e11b65375b25eea792597&bid="+uid;
	var backbutton = $("#results").html;

	$.ajax({url:bidURL,
			type:"GET",
			dataType: "json",
			username: "mmmmikep",
			password: "1ea8b3ac0640e44c27b3cb8a258a87f8",
			success:function(result){

			$("#results").html('<a href="http:/www.untappd.com/beer/'+uid+'"></a><br>');
       
			 $("#results").append('<p><font color="#FFFBB1" face="Gill Sans"><img src="'+result.results.img+'" width="125" height="125""><br>'+result.results.name+'</p>'+
			 	'<p>'+result.results.type+' - ABV: '+result.results.beer_abv+'%</p>'+'<p>Manufactured By: '+result.results.brewery+'</p><br>My Rating: '+ result.results.your_rating+'</font>');

	 		if(result.results.your_rating){
				 $("#results").append('My Rating: '+result.results.your_rating);}
			 else $("#result").append('You should log in or something man');

    
			},
			error: function(req, status, errThrown){
				$("#results").html("error:" + req + status + errThrown);
			}

  });
	}


  function searchBeer(){
		$("#results").html("Searching...");

		untappdAPIcall = "http://api.untappd.com/v3/beer_search?key=b6077c9e633e11b65375b25eea792597&sort=count&q="+$("#searchText").val();
    $.getJSON("http://api.untappd.com/v3/beer_search?key=b6077c9e633e11b65375b25eea792597&sort=count&q="+$("#searchText").val(),function(json){
		$("#results").html("Tap a beer for more info!");

      $.each(json.results, function(i,beer){
     // this is where we do what we want with the beer
      $("#results").append('<font color="#FFFBB1" face="Gill Sans"><p onclick="beerclick('+beer.beer_id+')"><img id="beerpic" title="'+beer.beer_id+'" src="'+beer.beer_stamp+'" widt="48" height="48" />'+beer.beer_name+'</font></p>');

		});
    
	});
  }
  

</script>		  


</head>
<body onload="initialize()" bgcolor="#6A2C0C" style="margin: 0; padding: 0">
<style> body{ 
background-image:url("http://i15.photobucket.com/albums/a377/TheAmelianator/1333058181_Drink_BeerPint-1.png");
background-repeat:no-repeat;
background-attachment:fixed;
background-position:right; 



}</style>

<h1><font color="#FFFBB1" face="Gill Sans">Beer Search</font></h1>


<p id="test"></p><br>
<button id="login" onclick="login()">Login</button>
<br>

<input type="text" id="searchText">
<button id="bSrch" onclick="searchBeer()">Search Beers</button><br>
<div id="results"><font color="#FFFBB1" face="Gill Sans">Enter a beer to search</font></div>





</body>
</html>